<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Configuration Example</title>
</head>
<body>
    <h1>Secure Configuration Usage Example</h1>
    <div id="status"></div>

    <!-- Load EVM file first (must be loaded before other scripts) -->
    <script src="evm.js"></script>
    
    <!-- Load configuration loader -->
    <script src="config-loader.js"></script>
    
    <!-- Example of using secure configuration -->
    <script>
        // Example: Initialize Firebase securely
        function initializeFirebase() {
            try {
                const firebaseConfig = ConfigManager.getFirebaseConfig();
                
                // Check if we're using fallback values
                if (ConfigManager.isUsingFallbackValues()) {
                    console.warn('‚ö†Ô∏è  Using fallback Firebase configuration. Please update evm.js with real values.');
                    document.getElementById('status').innerHTML = 
                        '<div style="color: orange;">‚ö†Ô∏è Using fallback configuration. Please configure evm.js file.</div>';
                    return;
                }
                
                // Initialize Firebase with secure config
                if (typeof firebase !== 'undefined') {
                    if (!firebase.apps.length) {
                        firebase.initializeApp(firebaseConfig);
                    }
                    console.log('‚úÖ Firebase initialized successfully');
                    document.getElementById('status').innerHTML = 
                        '<div style="color: green;">‚úÖ Firebase initialized with secure configuration</div>';
                }
            } catch (error) {
                console.error('‚ùå Failed to initialize Firebase:', error);
                document.getElementById('status').innerHTML = 
                    '<div style="color: red;">‚ùå Failed to initialize Firebase. Check evm.js file.</div>';
            }
        }
        
        // Example: Use Cloudinary configuration
        function uploadToCloudinarySecure(file) {
            const cloudinaryConfig = ConfigManager.getCloudinaryConfig();
            const folder = ConfigManager.getCloudinaryFolder('vehicles');
            
            console.log('Uploading to Cloudinary:', {
                cloudName: cloudinaryConfig.cloudName,
                uploadPreset: cloudinaryConfig.uploadPreset,
                folder: folder
            });
            
            // Your Cloudinary upload code here
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', cloudinaryConfig.uploadPreset);
            formData.append('folder', folder);
            
            return fetch(cloudinaryConfig.apiUrl, {
                method: 'POST',
                body: formData
            });
        }
        
        // Example: Use AI configuration
        function useAIConfig() {
            const aiConfig = ConfigManager.getAIConfig();
            console.log('AI Configuration loaded:', {
                hasGeminiKey: !!aiConfig.geminiApiKey,
                keyLength: aiConfig.geminiApiKey ? aiConfig.geminiApiKey.length : 0
            });
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing secure configuration...');
            
            // Show environment info
            const envInfo = ConfigManager.getEnvironmentInfo();
            console.log('Environment Info:', envInfo);
            
            // Initialize services
            initializeFirebase();
            useAIConfig();
        });
    </script>
</body>
</html>
