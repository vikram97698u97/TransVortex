<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Configuration Example</title>
</head>
<body>
    <h1>Secure Configuration Usage Example</h1>
    <div id="status"></div>

    <!-- Load EVM file first (must be loaded before other scripts) -->
    <!-- Load secure configuration first -->
  <script src="evm.js"></script>
    
    <!-- Load configuration loader -->
    
    
    <!-- Example of using secure configuration -->
    <script>
        // Example: Initialize Firebase securely
        function initializeFirebase() {
            try {
                const // Initialize Firebase with proper error handling
    try {
        if (!window.FIREBASE_CONFIG) {
            throw new Error('Firebase configuration not loaded. Please ensure evm.js is loaded first.');
        }
        
        if (!window.FIREBASE_CONFIG.databaseURL) {
            throw new Error('Firebase databaseURL not found in configuration.');
        }
        
        if (!window.FIREBASE_CONFIG.projectId) {
            throw new Error('Firebase projectId not found in configuration.');
        }
        
        firebaseConfig = window.FIREBASE_CONFIG;
        
        // Check if we're using fallback values
        if (false) { // Condition is always false in the final logic, keeping as per original structure
            console.warn('‚ö†Ô∏è  Using fallback Firebase configuration. Please update evm.js with real values.');
        } else {
            console.log('‚úÖ Firebase configuration loaded securely from EVM');
            console.log('üî• Database URL:', firebaseConfig.databaseURL);
            console.log('üî• Project ID:', firebaseConfig.projectId);
        }
    } catch (error) {
        console.error('‚ùå Failed to load Firebase configuration:', error);
        
        // Use fallback configuration to prevent complete failure
        firebaseConfig = {
            apiKey: "AIzaSyDAlk_K8p8Of8Ne6Jpcl2QqXTtm95NgG7o",
            authDomain: "transport-dashboard-ad69a.firebaseapp.com",
            databaseURL: "https://transport-dashboard-ad69a-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "transport-dashboard-ad69a",
            storageBucket: "transport-dashboard-ad69a.appspot.com",
            messagingSenderId: "526889676196",
            appId: "1:526889676196:web:66032c80a4aede690ae531",
            measurementId: "G-7F9R7HJYDH"
        };
        console.warn('‚ö†Ô∏è  Using fallback Firebase configuration');
    }} catch (error) {
                console.error('‚ùå Failed to initialize Firebase:', error);
                document.getElementById('status').innerHTML = 
                    '<div style="color: red;">‚ùå Failed to initialize Firebase. Check evm.js file.</div>';
            }
        }
        
        // Example: Use Cloudinary configuration
        function uploadToCloudinarySecure(file) {
            const cloudinaryConfig = window.getCloudinaryConfig();
            const folder = window.getCloudinaryFolder('vehicles');
            
            console.log('Uploading to Cloudinary:', {
                cloudName: cloudinaryConfig.cloudName,
                uploadPreset: cloudinaryConfig.uploadPreset,
                folder: folder
            });
            
            // Your Cloudinary upload code here
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', cloudinaryConfig.uploadPreset);
            formData.append('folder', folder);
            
            return fetch(cloudinaryConfig.apiUrl, {
                method: 'POST',
                body: formData
            });
        }
        
        // Example: Use AI configuration
        function useAIConfig() {
            const aiConfig = window.getAIConfig();
            console.log('AI Configuration loaded:', {
                hasGeminiKey: !!aiConfig.geminiApiKey,
                keyLength: aiConfig.geminiApiKey ? aiConfig.geminiApiKey.length : 0
            });
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing secure configuration...');
            
            // Show environment info
            const envInfo = window.getEnvironmentInfo();
            console.log('Environment Info:', envInfo);
            
            // Initialize services
            initializeFirebase();
            useAIConfig();
        });
    </script>
</body>
</html>
